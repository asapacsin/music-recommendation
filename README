# AI-Based Music Recommendation System

A self-contained, content-based music recommendation system that recommends similar music tracks based on uploaded audio files using deep audio embeddings and vector similarity search.

The system achieves approximately **80% recommendation precision**, compared to **~20% from random selection**, demonstrating a ~4× improvement.

---

## What This System Does

- Takes a music file as input
- Extracts deep audio embeddings using a pretrained neural network
- Searches a local music database for similar tracks
- Returns the Top-K most similar music files

This is a **pure content-based system** (no user data, no metadata).

---

## Core Pipeline (End-to-End)

1. Load audio files using `librosa`
2. Extract audio embeddings using `torchopenl3`
3. Store embeddings in a FAISS index
4. Perform nearest-neighbor search for recommendations

---

## Performance & Resources

- Recommendation precision: ~80%
- Random baseline: ~20%
- Embedding generation time: ~5 minutes for 100 music files
- Hardware: Single GPU with ~6 GB VRAM
- Deployment: Local, Dockerized, GPU-enabled

---

## Technology Stack

- Python
- PyTorch
- librosa
- torchopenl3
- FAISS
- Docker
- NVIDIA GPU

---

## Directory Layout

.
├── app/
│ ├── recommend.py
│ └── converters/
│ └── movie_convert.py
├── data/
│ ├── input/ # Query music files
│ ├── movie_input/ # Optional movie files
│ └── music_db/ # Music database
├── Dockerfile
└── README.md

yaml
Copy code

---

## Environment Setup (Docker)

Build the Docker image:

```bash
docker build -t your_image_name .
Run the container with GPU support:

bash
Copy code
docker run --gpus all -it --rm \
  --mount type=bind,source=host_path,target=container_path \
  your_image_name bash
Inside the container, install the project in editable mode:

bash
Copy code
pip install -e .
This ensures exact dependency versions are used.

Optional: Convert Movies to Audio
Movie files can be converted into audio files for recommendation.

bash
Copy code
python app/converters/movie_convert.py \
  -i input_path \
  -o output_path
Supported formats:
.mp4, .mkv, .avi, .mov, .flv

How to Use
Step 1: Build the Embedding Index
Run once or whenever the music database changes.

bash
Copy code
python app/recommend.py -b True
This extracts embeddings from data/music_db and builds the FAISS index.

Step 2: Run Recommendation
bash
Copy code
python app/recommend.py -r path_to_query_music_file
The system returns the Top-5 most similar tracks ranked by distance.

Example Output
AI-based recommendation:

powershell
Copy code
Using Genesis to recommendation:
Top Recommendations:
('data/music_db/premonition.mp3', 57.01)   Good
('data/music_db/flyingbird.mp3', 58.72)    Good
('data/music_db/snowgoddess.mp3', 59.62)   Good
('data/music_db/sakuraofwinter.mp3', 63.96) Good
('data/music_db/upinthesky.mp3', 65.46)    Bad
Precision: 4 / 5 = 80%

Random baseline:

bash
Copy code
data/music_db/sora.mp3                             Bad
data/music_db/durnkinwind.mp3                      Bad
data/music_db/streetwherewindsettles.mp3           Good
data/music_db/earlysummerrain.mp3                  Bad
data/music_db/Lightning Returns - FF XIII OST.mp3  Bad
Precision: 1 / 5 = 20%

Engineering Notes
Fully modular design

Clear API boundaries for backend or full-stack integration

GPU-aware embedding extraction

Dockerized for reproducibility

Scales to larger datasets via FAISS